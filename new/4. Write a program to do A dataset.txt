4. Write a program to do: A dataset collected in a cosmetics shop showing
 details of customers and whether or not they responded to a special offer
 to buy a new lip-stick is shown in table below. (Implement step by step
 using commands- Dont use library) Use this dataset to build a decision
 tree, with Buys as the target variable, to help in buying lipsticks in the
 future. Find the root node of the decision tree.


code

import pandas as pd

df = pd.read_csv(r"E:\TY\DSML_dataset\Lipstick.csv")

df.head()

x = df[["Age", "Income", "Gender", "Ms"]]
y = df["Buys"]


from sklearn.preprocessing import LabelEncoder

encoders = {}

for col in x.columns:
    le = LabelEncoder()
    x[col] = le.fit_transform(x[col])
    encoders[col] = le


le_y = LabelEncoder()
y = le_y.fit_transform(y)


from sklearn.tree import DecisionTreeClassifier

clf = DecisionTreeClassifier(criterion="entropy", random_state=0)
clf.fit(x, y)

test = pd.DataFrame(
    [["<21", "Low", "Female", "Married"]],
    columns=["Age", "Income", "Gender", "Ms"]
)

pred = clf.predict(test)

pred







































import pandas as pd
from sklearn.preprocessing import LabelEncoder
from sklearn.tree import DecisionTreeClassifier

# Read dataset
df = pd.read_csv(r"E:\TY\DSML_dataset\Lipstick.csv")

# Select input and output columns
x = df[["Age", "Income", "Gender", "Ms"]]
y = df["Buys"]

# Convert categorical values to numeric labels
for col in x.columns:
    le = LabelEncoder()
    x.loc[:, col] = le.fit_transform(x[col])     # prevents warning

le_y = LabelEncoder()
y = le_y.fit_transform(y)

# Build decision tree model
clf = DecisionTreeClassifier(criterion="entropy", random_state=0)
clf.fit(x, y)

# Print root node attribute name
root_index = clf.tree_.feature[0]
print("Root node feature:", x.columns[root_index])


