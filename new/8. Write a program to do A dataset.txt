 8. Write a program to do: A dataset collected in a cosmetics shop showing
 details of customers and whether or not they responded to a special offer
 to buy a newlip-stick is shown in table below. (Use library commands)
 According to the decision tree you have made from the previous training
 data set, what is the decision for the test data: [Age = 21-35, Income = Low,
 Gender = Male, Marital Status = Married]


code:

import pandas as pd

df = pd.read_csv(r"E:\TY\DSML_dataset\Lipstick.csv")

df.head()

x=df.iloc[:,1:5]

y=df.iloc[:,-1]

from sklearn.preprocessing import LabelEncoder

encoders = {}
for col in x.columns:
    le=LabelEncoder()
    x[col]=le.fit_transform(x[col])
    encoders[col]=le


le_y=LabelEncoder()
y= le_y.fit_transform(y)


from sklearn.tree import DecisionTreeClassifier

clf = DecisionTreeClassifier()
clf = clf.fit(x, y)

test = pd.DataFrame(
    [["21-35", "Low", "Male", "Married"]],
    columns=["Age", "Income", "Gender", "Ms"]
)

for col in test.columns:
    test[col] = encoders[col].transform(test[col])


pred=clf.predict(test)

pred






































import pandas as pd
from sklearn.preprocessing import LabelEncoder
from sklearn.tree import DecisionTreeClassifier

df = pd.read_csv(r"E:\TY\DSML_dataset\Lipstick.csv")

x = df.iloc[:, 1:5].copy()
y = df.iloc[:, -1].copy()

encoders = {}
for col in x.columns:
    le = LabelEncoder()
    x.loc[:, col] = le.fit_transform(x[col])
    encoders[col] = le

le_y = LabelEncoder()
y = le_y.fit_transform(y)

clf = DecisionTreeClassifier(criterion="entropy", random_state=0)
clf.fit(x, y)

test = pd.DataFrame(
    [["21-35", "Low", "Male", "Married"]],
    columns=["Age", "Income", "Gender", "Ms"]
)

for col in test.columns:
    test.loc[:, col] = encoders[col].transform(test[col])

pred = clf.predict(test)
result = le_y.inverse_transform(pred)[0]

print("Decision for test data:", result)








