 5. Write a program to do: A dataset collected in a cosmetics shop showing
 details of customers and whether or not they responded to a special offer
 to buy a newlip-stick is shown in table below. (Use library commands)
 According to the decision tree you have made from the previous training
 data set, what is the decision for the test data: [Age < 21, Income = Low,
 Gender = Female, Marital Status = Married]


code:

import pandas as pd


df = pd.read_csv(r"E:\TY\DSML_dataset\Lipstick.csv")

df.head()

x=df.iloc[:,1:5]

y=df["Buys"]

from sklearn.preprocessing import LabelEncoder

encoders = {}
for col in x.columns:
    le=LabelEncoder()
    x[col]=le.fit_transform(x[col])
    encoders[col]=le

le_y=LabelEncoder()
y= le_y.fit_transform(y)

from sklearn.tree import DecisionTreeClassifier

clf = DecisionTreeClassifier()
clf = clf.fit(x, y)


test = pd.DataFrame([["<21", "Low", "Female", "Married"]],
                    columns=["Age", "Income", "Gender", "Ms"])


for col in test.columns:
    test[col] = encoders[col].transform(test[col])


pred=clf.predict(test)

pred































import pandas as pd
from sklearn.preprocessing import LabelEncoder
from sklearn.tree import DecisionTreeClassifier

# Read dataset
df = pd.read_csv(r"E:\TY\DSML_dataset\Lipstick.csv")

# Input features (x) and target (y)
x = df.iloc[:, 1:5]      # Age, Income, Gender, Ms
y = df["Buys"]

# Encode categorical input features
encoders = {}
for col in x.columns:
    le = LabelEncoder()
    x.loc[:, col] = le.fit_transform(x[col])
    encoders[col] = le

# Encode target
le_y = LabelEncoder()
y = le_y.fit_transform(y)

# Train decision tree
clf = DecisionTreeClassifier(criterion="entropy", random_state=0)
clf.fit(x, y)

# Test data: [Age < 21, Income = Low, Gender = Female, Ms = Married]
test = pd.DataFrame(
    [["<21", "Low", "Female", "Married"]],
    columns=["Age", "Income", "Gender", "Ms"]
)

# Apply same encoders to test data
for col in test.columns:
    test[col] = encoders[col].transform(test[col])

# Predict class
pred = clf.predict(test)
result = le_y.inverse_transform(pred)[0]

print("Decision for [Age < 21, Income = Low, Gender = Female, Ms = Married]:", result)





